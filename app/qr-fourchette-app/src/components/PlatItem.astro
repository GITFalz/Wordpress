---
const { id, index, name, description, prix, traduisible, image, labels } = Astro.props;
let platId = id ?? Date.now(); // Use provided id or generate a new one
---

<div data-id={platId} data-index={index} data-type="plat" class="flex items-start px-4 py-3 cursor-pointer drag-item">
    <!-- Left side: index circle with plus button below -->
    <div class="flex flex-col items-center mr-4 select-none rounded-xl">
        <div class="cursor-move w-11 h-11 rounded-full bg-gray-900 hover:bg-gray-800 text-white flex items-center justify-center transition drag-handle">
        <p>{index}</p>
        <!-- Move icon -->
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrows-move" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M7.646.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 1.707V5.5a.5.5 0 0 1-1 0V1.707L6.354 2.854a.5.5 0 1 1-.708-.708zM8 10a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 14.293V10.5A.5.5 0 0 1 8 10M.146 8.354a.5.5 0 0 1 0-.708l2-2a.5.5 0 1 1 .708.708L1.707 7.5H5.5a.5.5 0 0 1 0 1H1.707l1.147 1.146a.5.5 0 0 1-.708.708zM10 8a.5.5 0 0 1 .5-.5h3.793l-1.147-1.146a.5.5 0 0 1 .708-.708l2 2a.5.5 0 0 1 0 .708l-2 2a.5.5 0 0 1-.708-.708L14.293 8.5H10.5A.5.5 0 0 1 10 8"/>
            </svg>
        </div>
        <button
            type="button"
            aria-label="Add"
            class="expand-categorie-item mt-2 w-8 h-8 rounded-full bg-yellow-400 hover:bg-yellow-300 text-white transition focus:outline-none focus:ring-2 focus:ring-yellow-400 toggle-menu-button"
        >
            <div class="flex items-center justify-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-fill" viewBox="0 0 16 16">
                    <path d="M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.5.5 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11z"/>
                </svg>
            </div>
        </button>
        <button
            type="button"
            aria-label="Add"
            class="hidden collapse-categorie-item mt-2 w-8 h-8 rounded-full bg-yellow-400 hover:bg-yellow-300 text-white transition focus:outline-none focus:ring-2 focus:ring-yellow-400 toggle-menu-button"
        >
            <div class="flex items-center justify-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-double-up" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M7.646 2.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 3.707 2.354 9.354a.5.5 0 1 1-.708-.708z"/>
                    <path fill-rule="evenodd" d="M7.646 6.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 7.707l-5.646 5.647a.5.5 0 0 1-.708-.708z"/>
                </svg>
            </div>
        </button>     
    </div>

    <!-- Right side: name and action buttons -->
    <div class="flex flex-col flex-grow">
        <div class="flex items-start justify-between flex-col space-y-2">
            <div class="flex flex-row space-x-2 w-full">
                <div class="w-full space-y-2 flex flex-col">
                    <p class="hidden expandable">Nom du plat</p>
                    <input
                        type="text"
                        name="name"
                        placeholder="Menu name"
                        class="plat-name rounded-xl p-2 focus:outline-none focus:ring-2 bg-gray-200 h-11 w-full saveable-input"
                        value={name}
                    />
                </div>
                <div class="w-full space-y-2 flex flex-col hidden expandable">
                    <p class="">Prix du plat</p>
                    <div class="flex flex-row justify-center items-center gap-5 pl-2 relative text-xs">
                        <div class="delete-icon bg-red-600 rounded-full text-white absolute left-0 top-0" onclick="deleteCategorieIcon(this)">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-x" viewBox="0 0 16 16">
                                <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"/>
                            </svg>
                        </div>
                        <input
                            type="number"
                            name="prix"
                            placeholder="Plat prix"
                            class="plat-prix rounded-xl p-2 focus:outline-none focus:ring-2 bg-gray-200 h-11 w-full"
                            value={prix}
                        />
                        <div class="icon-select absolute top-[100%] mt-2 left-0 w-full max-h-60 overflow-y-auto bg-white shadow-lg rounded z-50">
                        </div>
                    </div>
                </div>
            </div>
            <div class="w-full hidden expandable">
                <div class="flex flex-row space-x-2 w-full">
                    <div class="w-full space-y-2 flex flex-col">
                        <p>Description du plat / ingr√©dients</p>
                        <textarea
                            name="description"
                            placeholder="Menu description"
                            class="plat-description rounded-xl p-2 focus:outline-none focus:ring-2 bg-gray-200 h-32 w-full saveable-input"
                        >{description}</textarea>
                    </div>
                    <div class="w-full space-y-2 flex flex-col">
                        <p class="">Ce plat est-il traduisible?</p>
                        <div class="flex items-center">
                            <div class="flex items-center gap-6">
                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input
                                        type="radio"
                                        name={`traduisible${platId}`}
                                        value="1"
                                        class="w-5 h-5 plat-traduisible-oui categorie-traduisible saveable-input accent-yellow-400"
                                        checked={traduisible === true}
                                    />
                                    Oui
                                </label>

                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input
                                        type="radio"
                                        name={`traduisible${platId}`}
                                        value="0"
                                        class="w-5 h-5 plat-traduisible-non categorie-traduisible saveable-input accent-yellow-400"
                                        checked={traduisible !== true}
                                    />
                                    Non
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Buttons with horizontal line behind -->
        <div class="relative mt-4 flex items-center justify-center">
            <!-- The horizontal gray bar behind the buttons -->
            <div class="absolute inset-x-0 top-1/2 -translate-y-1/2 border-t border-gray-300"></div>

            <!-- Buttons container -->
            <div class="flex space-x-4 z-10">
                <button
                    onclick="addCategorieItemAfter(this)"
                    type="button"
                    aria-label="Add submenu"
                    class="w-8 h-8 rounded-full bg-yellow-400 hover:bg-yellow-300 text-white flex items-center justify-center transition focus:outline-none focus:ring-2 focus:ring-yellow-400"
                    >
                    <!-- Plus icon -->
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="16"
                        height="16"
                        fill="currentColor"
                        class="bi bi-plus"
                        viewBox="0 0 16 16"
                    >
                        <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
                    </svg>
                </button>
                <button
                    onclick="deleteCategorieItem(this)"
                    type="button"
                    aria-label="Delete menu"
                    class="w-8 h-8 rounded-full bg-yellow-400 hover:bg-yellow-300 text-white flex items-center justify-center transition focus:outline-none focus:ring-2 focus:ring-red-400 delete-menu-button"
                    >
                <!-- Trashcan icon -->
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        class="w-5 h-5"
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke="currentColor"
                        stroke-width="2"
                    >
                        <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5-4h4m-4 0a1 1 0 00-1 1v1h6V4a1 1 0 00-1-1m-4 0h4"
                        />
                    </svg>
                </button>
            </div>
        </div>
    </div>
</div>